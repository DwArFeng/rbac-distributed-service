# Pexp V1 - 权限表达式 V1 说明文档

## 说明

V1 权限表达式（一代权限表达式），是一种具备基础功能的权限表达式，可提供单一逻辑权限匹配工功能。

## 语法

V1 权限表达式的构成为：

```
[v1;]<修饰符><权限过滤器类型>@<权限过滤器匹配模式>
```

其精确的语法如下：

```
[v1;]<+|-|!><type@<pattern>
```

在其中：

`[v1;]` 是版本标识符，为了与 `1.8.0.a` 版本以前的权限表达式兼容，可以省略。

`<+|-|!>` 是权限修饰符：

- `+` 是接受修饰符，如果权限通过测试，则权限的接受程度为 `ACCEPT`。
- `-` 是排除修饰符，如果权限通过测试，则权限的接受程度为 `REJECT`。
- `!` 是全局排除修饰符，如果权限通过测试，则权限的接受程度为 `GLOBAL_REJECT`。

`type` 是权限过滤器，有关权限表达式的说明，请参阅文档中对应的章节。
需要注意的是，此版本的权限过滤器中不能含有字符 `@`，否则会造成解析失败。

`pattern` 是权限过滤器匹配模式，匹配模式的语法由权限过滤器类型决定。
您可以参考对应的权限过滤器的文档来了解匹配模式的语法，也可以在项目启动后重置权限过滤器支持，
并在数据库中的权限过滤器支持表 `tbl_permission_filter_support` 中查看对应的权限过滤器的 `example_pattern` 列。

## 示例

以下是一些 V1 权限表达式的示例（包含不合法的示例，请注意区分）：

| 序号 | 表达式         | 是否合法 | 描述                          |
|:---|:------------|:-----|:----------------------------|
| 1  | +foo@bar    | 合法   | 合法表达式，不包含版本前缀。              |
| 2  | -foo@bar    | 合法   | 合法表达式，不包含版本前缀。              |
| 3  | !foo@bar    | 合法   | 合法表达式，不包含版本前缀。              |
| 4  | v1;+foo@bar | 合法   | 合法表达式，包含版本前缀。               |
| 5  | v1;-foo@bar | 合法   | 合法表达式，包含版本前缀。               |
| 6  | v1;!foo@bar | 合法   | 合法表达式，包含版本前缀。               |
| 7  | $foo@bar    | 不合法  | 不合法表达式，不包含版本前缀，非法的修饰符。      |
| 8  | v1;$foo@bar | 不合法  | 不合法表达式，包含版本前缀，非法的修饰符。       |
| 9  | @bar        | 不合法  | 不合法表达式，不包含版本前缀，空的修饰符+过滤器类型。 |
| 10 | v1;@bar     | 不合法  | 不合法表达式，包含版本前缀，空的修饰符+过滤器类型。  |
| 11 | +@bar       | 不合法  | 不合法表达式，不包含版本前缀，空的过滤器类型。     |
| 12 | -@bar       | 不合法  | 不合法表达式，不包含版本前缀，空的过滤器类型。     |
| 13 | !@bar       | 不合法  | 不合法表达式，不包含版本前缀，空的过滤器类型。     |
| 14 | v1;+@bar    | 不合法  | 不合法表达式，包含版本前缀，空的过滤器类型。      |
| 15 | v1;-@bar    | 不合法  | 不合法表达式，包含版本前缀，空的过滤器类型。      |
| 16 | v1;!@bar    | 不合法  | 不合法表达式，包含版本前缀，空的过滤器类型。      |
| 17 | foo@bar     | 不合法  | 不合法表达式，不包含版本前缀，不包含修饰符。      |
| 18 | v1;foo@bar  | 不合法  | 不合法表达式，包含版本前缀，不包含修饰符。       |

## 建议

我们强烈建议您使用普通的字符（如小写字符与`-`, `_`, `.` 等分隔符）作为权限过滤器类型，
并且避免使用权限表达式种潜在的控制符与关键字。这样做会提高权限表达式的可维护性，也能使权限表达式更高概率成功解析。
